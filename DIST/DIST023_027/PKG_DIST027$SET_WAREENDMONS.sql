CREATE DEFINER=`ubidom`@`%` PROCEDURE `swmcp`.`PKG_DIST027$SET_WAREENDMONS`(	
	IN A_COMP_ID VARCHAR(10),
	IN A_YYMM TIMESTAMP,
	IN A_ITEM_CODE VARCHAR(30),
	IN A_ITEM_KIND BIGINT(20),
	IN A_LOT_NO VARCHAR(30),
	IN A_WARE_CODE BIGINT(20),
	IN A_PRE_QTY DECIMAL(16, 4),
	IN A_PRE_AMT DECIMAL(16, 4),
	IN A_IN_QTY DECIMAL(16, 4),
	IN A_IN_AMT DECIMAL(16, 4),
	IN A_OUT_QTY DECIMAL(16, 4),
	IN A_OUT_AMT DECIMAL(16, 4),
	IN A_NEXT_QTY DECIMAL(16, 4),
	IN A_NEXT_AMT DECIMAL(16, 4),
	IN A_SYS_EMP_NO VARCHAR(10),
    IN A_SYS_ID varchar(30),
	OUT N_RETURN INT,
	OUT V_RETURN VARCHAR(4000)
	)
begin

	declare V_YYMM VARCHAR(6);
	
	DECLARE EXIT HANDLER FOR SQLEXCEPTION 
	CALL USP_SYS_GET_ERRORINFO_ALL(V_RETURN, N_RETURN); 

	SET N_RETURN = 0;
  	SET V_RETURN = '저장되었습니다.'; 
  
    set V_YYMM = DATE_FORMAT(A_YYMM, '%Y%m');
  
	insert into TB_IO_END (
		COMP_ID
		,YYMM
		,ITEM_CODE
		,ITEM_KIND
		,LOT_NO
		,WARE_CODE
		,PRE_QTY
		,PRE_AMT
		,IN_QTY
		,IN_AMT
		,OUT_QTY
		,OUT_AMT
		,NEXT_QTY
		,NEXT_AMT
		,SYS_EMP_NO
    	,SYS_ID
    	,SYS_DATE
	) values (
		A_COMP_ID
		,V_YYMM
		,A_ITEM_CODE
		,A_ITEM_KIND
		,A_LOT_NO
		,A_WARE_CODE
		,A_PRE_QTY
		,A_PRE_AMT
		,A_IN_QTY
		,A_IN_AMT
		,A_OUT_QTY
		,A_OUT_AMT
		,A_NEXT_QTY
		,A_NEXT_AMT
		,A_SYS_EMP_NO
    	,A_SYS_ID
    	,SYSDATE()
	)
	;
	
	IF ROW_COUNT() = 0 THEN
  	  SET N_RETURN = -1;
      SET V_RETURN = '저장이 실패하였습니다.'; 
  	END IF;  
  
end